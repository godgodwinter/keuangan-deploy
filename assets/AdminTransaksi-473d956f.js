import{i as T,f as ae,r as k,C as se,a as B,o as l,c as r,b as e,t as a,u as o,n as w,e as Y,w as V,j as R,F as z,N as H,g as O,T as L,m as K,_ as $}from"./index-85076a8c.js";import{F as u}from"./FungsiCampur-1f52fc3b.js";import{A as I}from"./axios-526409ed.js";import{m as h,l as oe}from"./id-225c17f7.js";import{u as ne}from"./adminRekapStore-41d73e9e.js";import{A as le}from"./apiProfile-bc3794eb.js";import{u as re}from"./dataProfile-4b1b7f2c.js";import"./adminAuthStore-91537484.js";const ie={class:"pt-4 px-5 md:flex justify-between items-center"},de=e("span",{class:"text-2xl sm:text-3xl leading-none font-bold text-base-content shadow-sm uppercase"}," REKAP TRANSAKSI HARIAN ",-1),ce={class:"text-sm font-light mt-1"},ue={class:"md:py-0 py-4 flex justify-end"},me={class:"badge badge-lg gap-2 py-3 px-4 rounded-lg shadow-md flex items-center transition-all duration-200 hover:shadow-lg"},pe={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"inline-block w-5 h-5 stroke-current"},_e={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},he={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},fe=e("span",{class:"font-medium"},"Hak Akses:",-1),xe={class:"p-4"},ve={class:"tabs tabs-boxed bg-base-200"},ge=e("a",{class:"tab tab-active"},"Harian",-1),be=e("a",{class:"tab"},"Bulanan",-1),ye=e("a",{class:"tab"},"Tahunan",-1),ke={class:"pt-2 px-5 flex justify-end"},we={class:"flex gap-2 items-center bg-white p-2 rounded shadow-sm"},De={key:0},Me={key:1},Re={key:2},Ae={key:0,class:"font-mono mt-4"},Pe={class:"w-full py-6 px-4 md:px-2 flex justify-center shadow-lg bg-base-100 rounded-xl mx-4 max-w-[97%] border border-gray-100"},Ye={class:"grid grid-cols-3 w-full text-center divide-x"},je=e("div",{class:"font-bold text-xs uppercase text-gray-500"}," Pemasukan ",-1),Le={class:"text-xl sm:text-2xl font-bold text-sky-600 mt-1"},Ce=e("div",{class:"font-bold text-xs uppercase text-gray-500"}," Pengeluaran ",-1),Ne={class:"text-xl sm:text-2xl font-bold text-red-600 mt-1"},Ve=e("div",{class:"font-bold text-xs uppercase text-gray-500"}," Saldo ",-1),Ee={key:0},Se=e("div",{class:"text-xs font-semibold uppercase text-gray-600 my-4 text-center"}," RINCIAN PER KEPEMILIKAN ",-1),Fe={class:"mx-4 max-w-[97%] grid md:grid-cols-2 gap-4"},Te={class:"bg-base-200 p-4 rounded-lg shadow-md"},ze=e("h3",{class:"font-bold text-lg mb-3"},[O("Rekap Data User "),e("span",{class:"badge badge-sm badge-success ml-2"},"Saya")],-1),Be={class:"space-y-2"},He={class:"flex justify-between"},Ke=e("span",{class:"text-sm text-gray-600"},"Pemasukan",-1),$e={class:"text-lg font-bold text-sky-600"},Ie={class:"flex justify-between"},Oe=e("span",{class:"text-sm text-gray-600"},"Pengeluaran",-1),Ue={class:"text-lg font-bold text-red-600"},Ge=e("hr",{class:"border-t border-gray-300 my-2"},null,-1),qe={class:"flex justify-between"},We=e("span",{class:"text-sm font-bold"},"Saldo",-1),Je={key:0,class:"bg-base-200 p-4 rounded-lg shadow-md"},Qe=e("h3",{class:"font-bold text-lg mb-3"},[O("Rekap Data User "),e("span",{class:"badge badge-sm badge-neutral ml-2"},"User Lain")],-1),Xe={class:"space-y-2"},Ze={class:"flex justify-between"},et=e("span",{class:"text-sm text-gray-600"},"Pemasukan",-1),tt={class:"text-lg font-bold text-sky-600"},at={class:"flex justify-between"},st=e("span",{class:"text-sm text-gray-600"},"Pengeluaran",-1),ot={class:"text-lg font-bold text-red-600"},nt=e("hr",{class:"border-t border-gray-300 my-2"},null,-1),lt={class:"flex justify-between"},rt=e("span",{class:"text-sm font-bold"},"Saldo",-1),it={key:1,class:"text-center py-10 opacity-50 text-sm"},dt={class:"flex bg-base-200 p-3 rounded-t-lg items-center justify-between border-b border-gray-300"},ct={class:"flex items-center space-x-3"},ut={class:"text-3xl font-bold text-slate-700"},mt={class:"flex flex-col leading-tight"},pt={class:"font-bold text-lg"},_t={class:"text-sm text-gray-500"},ht={class:"text-right text-xs sm:text-sm"},ft={class:"text-sky-600 font-bold"},xt={class:"text-red-600 font-bold"},vt={class:"bg-white shadow rounded-b-lg overflow-hidden border border-t-0 border-gray-200"},gt={class:"col-span-4 md:col-span-3 p-3 flex items-start space-x-2 border-r border-gray-100"},bt=["onClick"],yt=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1),kt=[yt],wt={class:"flex flex-col"},Dt={class:"text-sm font-semibold text-gray-700"},Mt={class:"mt-1 text-[11px] text-gray-500"},Rt=e("span",null,"Diinput oleh:",-1),At={key:0,class:"ml-1 px-2 py-[1px] rounded-full bg-emerald-100 text-emerald-700 text-[10px]"},Pt={key:1,class:"ml-1 px-2 py-[1px] rounded-full bg-amber-100 text-amber-700 text-[10px]"},Yt={class:"col-span-5 md:col-span-6 p-3 border-r border-gray-100 flex flex-col justify-center"},jt={class:"font-mono font-medium text-gray-700 text-sm break-words"},Lt={class:"col-span-3 md:col-span-3 p-3 flex flex-col items-end justify-center"},Ct=["onClick"],Nt={key:0,class:"btn btn-circle btn-ghost btn-xs text-gray-300 group-hover:text-blue-500"},Vt=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})],-1),Et=[Vt],Ot={__name:"AdminTransaksi",setup(St){h.updateLocale("id",oe);const U=re(),A=T(()=>U.getData),G=ae(),f=T(()=>{var i,m,s,p,t,_;const n=(s=(m=(i=A.value)==null?void 0:i.username)==null?void 0:m.toLowerCase)==null?void 0:s.call(m),c=(_=(t=(p=A.value)==null?void 0:p.username)==null?void 0:t.toLowerCase)==null?void 0:_.call(t);return n==="admin"||n==="superadmin"||c==="admin"}),q=async()=>{await le.getData()||L.warning("Info","Data profil tidak ditemukan")};A.value||q();const W=K(()=>$(()=>import("./AlertLoading-7fa38f04.js"),["assets/AlertLoading-7fa38f04.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/index-85076a8c.js","assets/index-0b89a117.css"])),J=K(()=>$(()=>import("./AlertFailed-aa759850.js"),["assets/AlertFailed-aa759850.js","assets/index-85076a8c.js","assets/index-0b89a117.css"])),E=ne(),P=T(()=>E.getdateNow);P.value===null&&E.setdateNow(h().format("YYYY-MM-DD"));const C=k({monthyear:{month:0,year:0}});C.value.monthyear={month:parseInt(h(P.value).format("MM"))-1,year:parseInt(h(P.value).format("YYYY"))};const j=k([]),b=k({}),x=k({}),v=k({}),Q=k([]),N=k(!0),S=k(!1),X=async()=>{E.setdateNow(h(C.value.monthyear).format("YYYY-MM-DD")),await F()},Z=n=>{let c=0,i=0;return n.forEach(m=>{const s=Number(m.pemasukan)||0,p=Number(m.pengeluaran)||0;c+=s,i+=p}),{pemasukan:c,pengeluaran:i,saldo:c-i}},F=async()=>{try{if(!A.value)return;N.value=!0,S.value=!1;const n={month:parseInt(h(P.value).format("MM")),year:parseInt(h(P.value).format("YYYY"))},c=await I.get(`admin/data_transaksi/detail?month=${n.month}&year=${n.year}`),i=c.data||[],m=c.rekap||{pemasukan:0,pengeluaran:0,saldo:0};Q.value=i,b.value=m,x.value={pemasukan:0,pengeluaran:0,saldo:0},v.value={pemasukan:0,pengeluaran:0,saldo:0};let s=[];if(f.value){s=i;const p=[],t=[];i.forEach(y=>{var D;(D=y.detail)==null||D.forEach(g=>{g.milik_sendiri===!0?p.push(g):t.push(g)})});const _=y=>{const D=y.filter(d=>d.jenis==="Pemasukan").reduce((d,M)=>d+parseFloat(M.nominal||0),0),g=y.filter(d=>d.jenis==="Pengeluaran").reduce((d,M)=>d+parseFloat(M.nominal||0),0);return{pemasukan:D,pengeluaran:g,saldo:D-g}};x.value=_(p),v.value=_(t)}else{const p=i.map(t=>{var g;const _=((g=t.detail)==null?void 0:g.filter(d=>d.milik_sendiri===!0))||[],y=_.filter(d=>d.jenis==="Pemasukan").reduce((d,M)=>d+parseFloat(M.nominal||0),0),D=_.filter(d=>d.jenis==="Pengeluaran").reduce((d,M)=>d+parseFloat(M.nominal||0),0);return{...t,detail:_,pemasukan:y,pengeluaran:D}}).filter(t=>t.detail.length>0);s=p,x.value=Z(p),b.value=x.value,v.value={pemasukan:0,pengeluaran:0,saldo:0}}j.value=s,N.value=!1}catch(n){N.value=!1,S.value=!0,L.danger("Warning","Data Gagal dimuat"),console.error(n)}};se(A,n=>{n&&F()},{immediate:!0});const ee=async n=>{console.log("#doDeleteData:",n);const c=j.value.some(i=>i.detail.some(m=>m.id===n&&m.milik_sendiri));f.value||c?confirm("Apakah anda yakin menghapus data ini?")&&(await I.delete(`admin/transaksi/${n}`)?(L.success("Info","Data berhasil dihapus!"),F()):L.danger("Info","Data gagal dihapus!")):L.warning("Akses Ditolak","Anda hanya dapat menghapus transaksi yang Anda input.")},te=async n=>{G.push({name:"admin-transaksi-edit",params:{transaksi_id:n}})};return(n,c)=>{const i=B("RouterLink"),m=B("Datepicker");return l(),r(z,null,[e("div",ie,[e("div",null,[de,e("div",ce," Bulan: **"+a(o(h)(P.value).format("MMMM YYYY"))+"** ",1)]),e("div",ue,[e("div",me,[(l(),r("svg",pe,[f.value?(l(),r("path",_e)):(l(),r("path",he))])),fe,e("span",{class:w(["ml-2 px-2 py-0.5 rounded-full text-xs font-bold",f.value?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"])},a(f.value?"Admin":"Kasir"),3)])])]),e("div",xe,[e("div",ve,[Y(i,{to:{name:"admin-transaksi-harian"}},{default:V(()=>[ge]),_:1}),Y(i,{to:{name:"admin-transaksi-bulanan"}},{default:V(()=>[be]),_:1}),Y(i,{to:{name:"admin-transaksi-tahunan"}},{default:V(()=>[ye]),_:1})])]),e("div",ke,[e("div",we,[Y(m,{format:"MMMM yyyy","value-format":"yyyy-MM",modelValue:C.value.monthyear,"onUpdate:modelValue":c[0]||(c[0]=s=>C.value.monthyear=s),monthPicker:"",required:""},{"calendar-header":V(({index:s,day:p})=>[e("div",{class:w(s===5||s===6?"red-color":"")},a(p),3)]),_:1},8,["modelValue"]),e("button",{class:"btn btn-sm btn-primary",onClick:c[1]||(c[1]=s=>X())}," Pilih ")])]),N.value?(l(),r("span",De,[Y(o(W))])):S.value?(l(),r("span",Me,[Y(o(J),{message:"Gagal mendapatkan response dari server"})])):(l(),r("span",Re,[j.value?(l(),r("div",Ae,[e("div",Pe,[e("div",Ye,[e("div",null,[je,e("div",Le,a(o(u).formatRupiah(b.value.pemasukan||0)),1)]),e("div",null,[Ce,e("div",Ne,a(o(u).formatRupiah(b.value.pengeluaran||0)),1)]),e("div",null,[Ve,e("div",{class:w(["text-xl sm:text-2xl font-bold mt-1",b.value.saldo<0?"text-red-500":"text-sky-500"])},a(b.value.saldo<0?o(u).formatRupiahMinus(b.value.saldo||0):o(u).formatRupiah(b.value.saldo||0)),3)])])]),A.value.username=="admin"?(l(),r("span",Ee,[Se,e("div",Fe,[e("div",Te,[ze,e("div",Be,[e("div",He,[Ke,e("span",$e,a(o(u).formatRupiah(x.value.pemasukan||0)),1)]),e("div",Ie,[Oe,e("span",Ue,a(o(u).formatRupiah(x.value.pengeluaran||0)),1)]),Ge,e("div",qe,[We,e("span",{class:w(["text-lg font-bold",x.value.saldo<0?"text-red-500":"text-sky-500"])},a(x.value.saldo<0?o(u).formatRupiahMinus(x.value.saldo||0):o(u).formatRupiah(x.value.saldo||0)),3)])])]),f.value?(l(),r("div",Je,[Qe,e("div",Xe,[e("div",Ze,[et,e("span",tt,a(o(u).formatRupiah(v.value.pemasukan||0)),1)]),e("div",at,[st,e("span",ot,a(o(u).formatRupiah(v.value.pengeluaran||0)),1)]),nt,e("div",lt,[rt,e("span",{class:w(["text-lg font-bold",v.value.saldo<0?"text-red-500":"text-sky-500"])},a(v.value.saldo<0?o(u).formatRupiahMinus(v.value.saldo||0):o(u).formatRupiah(v.value.saldo||0)),3)])])])):R("",!0)])])):R("",!0),j.value.length===0?(l(),r("div",it," Tidak ada data transaksi ditemukan untuk bulan ini. ")):R("",!0),(l(!0),r(z,null,H(j.value,(s,p)=>(l(),r("div",{class:"w-full py-4 flex-col justify-center px-4 space-y-4",key:p},[e("div",dt,[e("div",ct,[e("span",ut,a(o(h)(s.nama).format("DD")),1),e("div",mt,[e("span",pt,a(o(h)(s.nama).format("MMMM YYYY")),1),e("span",_t,a(o(h)(s.nama).format("dddd")),1)])]),e("div",ht,[e("div",ft," In: "+a(o(u).formatRupiah(s.pemasukan||0)),1),e("div",xt," Out: "+a(o(u).formatRupiah(s.pengeluaran||0)),1)])]),e("div",vt,[(l(!0),r(z,null,H(s.detail,(t,_)=>(l(),r("div",{class:w(["grid grid-cols-12 w-full border-b border-gray-100 last:border-0 transition-all",{"bg-yellow-50":f.value&&!t.milik_sendiri}]),key:t.id},[e("div",gt,[f.value||t.milik_sendiri?(l(),r("button",{key:0,class:"btn btn-circle btn-ghost btn-xs text-gray-300 hover:text-red-500 hover:bg-red-50",onClick:y=>ee(t.id)},kt,8,bt)):R("",!0),e("div",wt,[e("span",Dt,a(_+1)+". "+a(t.kategori_nama),1),e("div",Mt,[Rt,e("span",{class:w(["ml-1 font-semibold",t.milik_sendiri?"text-emerald-600":"text-amber-700"])},a(t.users_username||t.users_nama||"unknown"),3),t.milik_sendiri?(l(),r("span",At," Anda ")):f.value?(l(),r("span",Pt," user lain ")):R("",!0)])])]),e("div",Yt,[e("span",jt,a(t.nama),1)]),e("div",Lt,[e("div",{class:"flex items-center gap-2 group cursor-pointer",onClick:y=>te(t.id)},[e("span",{class:w(["font-mono font-bold text-sm sm:text-base text-right",t.jenis=="Pengeluaran"?"text-red-600":"text-sky-600"])},a(o(u).formatRupiah(t.nominal||0)),3),f.value||t.milik_sendiri?(l(),r("button",Nt,Et)):R("",!0)],8,Ct)])],2))),128))])]))),128))])):R("",!0)]))],64)}}};export{Ot as default};
