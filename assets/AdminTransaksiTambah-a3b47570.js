import{f as X,i as V,r,s as R,a as Z,o as p,c as v,b as a,g,t as _,u as o,e as d,n as b,w as N,j as C,v as aa,T as f,p as ea,l as ta,m as E,_ as F}from"./index-cee19467.js";import{A as U}from"./axios-526409ed.js";import{F as P,f as B,a as sa}from"./babengValidasi-7b5443b8.js";import{m as L,l as la}from"./id-c944ffbf.js";import{A as na}from"./apiProfile-38c3c52d.js";import{u as oa}from"./dataProfile-3bdee8a0.js";import{_ as ia}from"./_plugin-vue_export-helper-c27b6911.js";import"./adminAuthStore-608b6f41.js";const m=x=>(ea("data-v-70abbb76"),x=x(),ta(),x),ra={class:"min-h-screen bg-base-200 p-6"},da={class:"pt-4 px-5 md:flex justify-between items-center border-b pb-4"},ua=m(()=>a("h1",{class:"text-2xl sm:text-3xl font-extrabold text-base-content uppercase"}," âž• TAMBAH TRANSAKSI BARU ",-1)),ma={class:"text-sm text-gray-500"},ca={class:"font-semibold text-base-content"},pa={class:"md:py-0 py-4 space-x-2 space-y-2"},va=m(()=>a("i",{class:"fas fa-arrow-left mr-2"},null,-1)),ga={key:0},_a={key:1},ba={key:2},fa={class:"w-full py-6 flex justify-center"},xa={class:"tabs tabs-boxed bg-base-300"},ka={key:0,class:"px-4 py-4 max-w-4xl mx-auto"},ha={class:"w-full"},ya={class:"shadow-xl rounded-lg p-6 bg-base-100"},Da={class:"grid md:grid-cols-2 gap-4"},wa=m(()=>a("label",{for:"tgl",class:"label"},[a("span",{class:"label-text text-base-content"},[g("Tanggal Transaksi "),a("span",{class:"text-error"},"*")])],-1)),Pa={class:"text-xs text-error mt-1"},Aa={for:"kategori",class:"label"},Ta=m(()=>a("span",{class:"label-text text-base-content"},[g("Kategori "),a("span",{class:"text-error"},"*")],-1)),Va={key:0,class:"label-text-alt text-primary"},ja={class:"text-xs text-error mt-1"},Sa=m(()=>a("label",{for:"nominal",class:"label"},[a("span",{class:"label-text text-base-content"},[g("Jumlah / Nominal (IDR) "),a("span",{class:"text-error"},"*")])],-1)),Ia={class:"text-xs text-error mt-1"},Ka={class:"md:col-span-2"},Ra=m(()=>a("label",{for:"nama",class:"label"},[a("span",{class:"label-text text-base-content"},"Keterangan")],-1)),Na={class:"text-xs text-error mt-1"},Ca=m(()=>a("div",{class:"w-full flex justify-end mt-8"},[a("button",{type:"submit",class:"btn btn-primary btn-lg"},[a("i",{class:"fas fa-save mr-2"}),g(" Simpan Transaksi ")])],-1)),Ea={__name:"AdminTransaksiTambah",setup(x){L.updateLocale("id",la);const A=X(),$=oa(),k=V(()=>$.getData),j=r(null),M=async()=>{j.value=await na.getData(),j.value||(f.warning("Info","Data tidak ditemukan"),A.push({name:"AdminSkills"}))};R(()=>{k.value||M()});const O=E(()=>F(()=>import("./AlertLoading-8fc4a207.js"),["assets/AlertLoading-8fc4a207.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/index-cee19467.js","assets/index-0b89a117.css"])),Y=E(()=>F(()=>import("./AlertFailed-4036bfca.js"),["assets/AlertFailed-4036bfca.js","assets/index-cee19467.js","assets/index-0b89a117.css"])),T=r([]),S=r([]),t=r({tgl:L().format("YYYY-MM-DD"),jenis:"Pengeluaran",kategori_id:null,nominal:"",nama:""}),h=r([]),y=r({}),D=r(!0),I=r(!1),K={label:"kantor",id:18},u=V(()=>k.value&&k.value.username==="admin"),G=V(()=>!u.value),w=async(s=t.value.jenis)=>{try{if(D.value=!0,!u.value)T.value=[K];else{const e=await U.get(`admin/data_kategori/jenis?jenis=${s}`);T.value=e.data}z(s),D.value=!1}catch(e){D.value=!1,I.value=!0,f.danger("Warning","Data Gagal dimuat"),console.error(e)}},z=s=>{S.value=T.value,h.value=S.value.map(e=>({label:e.nama,id:e.id})),h.value.length>0?u.value?t.value.kategori_id=h.value[0]:t.value.kategori_id=K:t.value.kategori_id=null};R(()=>{w(t.value.jenis)});const H=async()=>{t.value.jenis="Pengeluaran",t.value.kategori_id=null,await w("Pengeluaran")},J=async()=>{if(!u.value){f.warning("Akses Dibatasi","Anda hanya dapat membuat Pengeluaran dengan kategori Kantor."),t.value.jenis="Pengeluaran",await w("Pengeluaran");return}t.value.jenis="Pemasukan",t.value.kategori_id=null,await w("Pemasukan")},W=s=>{if(!t.value.kategori_id){y.value.kategori_id="Kategori harus diisi";return}y.value.kategori_id="";const e=s.nominal?s.nominal.toString().replace(/\D/g,""):"";let c={tgl:s.tgl,nama:s.nama,nominal:e,kategori_id:t.value.kategori_id.id,jenis:t.value.jenis};q(c)},q=async s=>{var e,c;console.log("Data dikirim:",s);try{await U.post("admin/transaksi",s)&&(f.success("Info","Data berhasil ditambahkan!"),A.push({name:"admin-transaksi"}))}catch(i){let l="Terjadi kesalahan jaringan atau server.";(c=(e=i.response)==null?void 0:e.data)!=null&&c.message?l=i.response.data.message:i.message&&(l=i.message),f.danger("Error",l),console.error("Kesalahan saat submit:",i)}},Q=()=>{const s=t.value.nominal.toString().replace(/\D/g,"");if(!s){t.value.nominal="";return}const e=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0});t.value.nominal=e.format(parseInt(s,10))};return(s,e)=>{var i;const c=Z("v-select");return p(),v("div",ra,[a("div",da,[a("div",null,[ua,a("p",ma,[g(" Data Transaksi untuk pengguna: "),a("span",ca,_(((i=k.value)==null?void 0:i.username)||"..."),1)])]),a("div",pa,[a("button",{onClick:e[0]||(e[0]=l=>o(A).back()),class:"btn btn-ghost"},[va,g(" Kembali ")])])]),D.value?(p(),v("span",ga,[d(o(O))])):I.value?(p(),v("span",_a,[d(o(Y),{message:"Gagal mendapatkan response dari server"})])):(p(),v("span",ba,[a("div",fa,[a("div",xa,[a("a",{class:b(["tab",{"tab-active":t.value.jenis=="Pengeluaran"}]),onClick:e[1]||(e[1]=l=>H())}," ðŸ’¸ Pengeluaran ",2),a("a",{class:b(["tab",{"tab-active":t.value.jenis=="Pemasukan","tab-disabled":!u.value}]),onClick:e[2]||(e[2]=l=>J())}," ðŸ’° Pemasukan ",2)])]),t.value?(p(),v("div",ka,[a("div",ha,[a("div",ya,[d(o(sa),{onSubmit:W},{default:N(({errors:l})=>[a("div",Da,[a("div",null,[wa,d(o(P),{rules:o(B).validateData2,modelValue:t.value.tgl,"onUpdate:modelValue":e[3]||(e[3]=n=>t.value.tgl=n),name:"tgl",type:"date",class:b(["input input-bordered w-full",{"input-error":l.tgl}])},null,8,["rules","modelValue","class"]),a("div",Pa,_(l.tgl),1)]),a("div",null,[a("label",Aa,[Ta,u.value?C("",!0):(p(),v("span",Va,"(Hanya Kantor)"))]),d(o(P),{modelValue:t.value.jenis,"onUpdate:modelValue":e[4]||(e[4]=n=>t.value.jenis=n),name:"jenis",type:"hidden"},null,8,["modelValue"]),d(c,{class:b(["style-chooser w-full",{"border-error":y.value.kategori_id}]),options:h.value,modelValue:t.value.kategori_id,"onUpdate:modelValue":e[5]||(e[5]=n=>t.value.kategori_id=n),clearable:u.value,disabled:G.value,placeholder:"Pilih Kategori"},null,8,["options","modelValue","clearable","disabled","class"]),a("div",ja,_(y.value.kategori_id),1)]),a("div",null,[Sa,d(o(P),{rules:o(B).validateData2,modelValue:t.value.nominal,"onUpdate:modelValue":e[6]||(e[6]=n=>t.value.nominal=n),name:"nominal",type:"text",class:b(["input input-bordered w-full",{"input-error":l.nominal}]),onKeyup:e[7]||(e[7]=n=>Q()),placeholder:"Contoh: 15.000"},null,8,["rules","modelValue","class"]),a("div",Ia,_(l.nominal),1)]),a("div",Ka,[Ra,d(o(P),{modelValue:t.value.nama,"onUpdate:modelValue":e[8]||(e[8]=n=>t.value.nama=n),name:"nama"},{default:N(({field:n})=>[a("textarea",aa(n,{class:["textarea textarea-bordered w-full h-24",{"textarea-error":l.nama}],placeholder:"Tulis keterangan transaksi di sini..."}),null,16)]),_:2},1032,["modelValue"]),a("div",Na,_(l.nama),1)])]),Ca]),_:1})])])])):C("",!0)]))])}}},Ga=ia(Ea,[["__scopeId","data-v-70abbb76"]]);export{Ga as default};
