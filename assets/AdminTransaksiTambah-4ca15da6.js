import{f as Z,i as j,r,s as N,a as aa,o as d,c as u,b as a,g as _,t as f,u as o,e as m,n as b,w as C,j as E,v as ea,T as x,p as ta,l as sa,m as F,_ as U}from"./index-85076a8c.js";import{A as B}from"./axios-526409ed.js";import{F as A,f as L,a as la}from"./babengValidasi-33405028.js";import{m as M,l as na}from"./id-225c17f7.js";import{A as oa}from"./apiProfile-bc3794eb.js";import{u as ia}from"./dataProfile-4b1b7f2c.js";import{_ as ra}from"./_plugin-vue_export-helper-c27b6911.js";import"./adminAuthStore-91537484.js";const c=k=>(ta("data-v-113f4bff"),k=k(),sa(),k),da={class:"min-h-screen bg-base-200 p-6"},ua={class:"pt-4 px-5 md:flex justify-between items-center border-b pb-4"},ma=c(()=>a("h1",{class:"text-2xl sm:text-3xl font-extrabold text-base-content uppercase"}," âž• TAMBAH TRANSAKSI BARU ",-1)),ca={class:"text-sm text-gray-500"},pa={class:"font-semibold text-base-content"},_a={class:"md:py-0 py-4 space-x-2 space-y-2"},va=c(()=>a("i",{class:"fas fa-arrow-left mr-2"},null,-1)),ga={key:0},fa={key:1},ba={key:2},xa={class:"w-full py-6 flex justify-center"},ka={class:"tabs tabs-boxed bg-base-300"},ha={key:0,class:"px-4 py-4 max-w-4xl mx-auto"},ya={class:"w-full"},Da={class:"shadow-xl rounded-lg p-6 bg-base-100"},wa={class:"grid md:grid-cols-2 gap-4"},Pa=c(()=>a("label",{for:"tgl",class:"label"},[a("span",{class:"label-text text-base-content"},[_("Tanggal Transaksi "),a("span",{class:"text-error"},"*")])],-1)),Aa={class:"text-xs text-error mt-1"},Ta={for:"kategori",class:"label"},Va=c(()=>a("span",{class:"label-text text-base-content"},[_("Kategori "),a("span",{class:"text-error"},"*")],-1)),ja={key:0,class:"label-text-alt text-primary"},Sa={class:"text-xs text-error mt-1"},Ia=c(()=>a("label",{for:"nominal",class:"label"},[a("span",{class:"label-text text-base-content"},[_("Jumlah / Nominal (IDR) "),a("span",{class:"text-error"},"*")])],-1)),Ka={class:"text-xs text-error mt-1"},Ra={class:"md:col-span-2"},Na=c(()=>a("label",{for:"nama",class:"label"},[a("span",{class:"label-text text-base-content"},"Keterangan")],-1)),Ca={class:"text-xs text-error mt-1"},Ea={class:"w-full flex justify-end mt-8"},Fa=["disabled"],Ua={key:0,class:"flex items-center"},Ba=c(()=>a("i",{class:"fas fa-spinner fa-spin mr-2"},null,-1)),La={key:1,class:"flex items-center"},Ma=c(()=>a("i",{class:"fas fa-save mr-2"},null,-1)),$a={__name:"AdminTransaksiTambah",setup(k){M.updateLocale("id",na);const T=Z(),$=ia(),h=j(()=>$.getData),S=r(null),O=async()=>{S.value=await oa.getData(),S.value||(x.warning("Info","Data tidak ditemukan"),T.push({name:"AdminSkills"}))};N(()=>{h.value||O()});const Y=F(()=>U(()=>import("./AlertLoading-7fa38f04.js"),["assets/AlertLoading-7fa38f04.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/index-85076a8c.js","assets/index-0b89a117.css"])),G=F(()=>U(()=>import("./AlertFailed-aa759850.js"),["assets/AlertFailed-aa759850.js","assets/index-85076a8c.js","assets/index-0b89a117.css"])),V=r([]),I=r([]),t=r({tgl:M().format("YYYY-MM-DD"),jenis:"Pengeluaran",kategori_id:null,nominal:"",nama:""}),y=r([]),D=r({}),w=r(!0),K=r(!1),g=r(!1),R={label:"kantor",id:18},p=j(()=>h.value&&h.value.username==="admin"),z=j(()=>!p.value),P=async(s=t.value.jenis)=>{try{if(w.value=!0,!p.value)V.value=[R];else{const e=await B.get(`admin/data_kategori/jenis?jenis=${s}`);V.value=e.data}H(s),w.value=!1}catch(e){w.value=!1,K.value=!0,x.danger("Warning","Data Gagal dimuat"),console.error(e)}},H=s=>{I.value=V.value,y.value=I.value.map(e=>({label:e.nama,id:e.id})),y.value.length>0?p.value?t.value.kategori_id=y.value[0]:t.value.kategori_id=R:t.value.kategori_id=null};N(()=>{P(t.value.jenis)});const J=async()=>{t.value.jenis="Pengeluaran",t.value.kategori_id=null,await P("Pengeluaran")},W=async()=>{if(!p.value){x.warning("Akses Dibatasi","Anda hanya dapat membuat Pengeluaran dengan kategori Kantor."),t.value.jenis="Pengeluaran",await P("Pengeluaran");return}t.value.jenis="Pemasukan",t.value.kategori_id=null,await P("Pemasukan")},q=s=>{if(!t.value.kategori_id){D.value.kategori_id="Kategori harus diisi";return}if(g.value)return;D.value.kategori_id="";const e=s.nominal?s.nominal.toString().replace(/\D/g,""):"";let v={tgl:s.tgl,nama:s.nama,nominal:e,kategori_id:t.value.kategori_id.id,jenis:t.value.jenis};Q(v)},Q=async s=>{var e,v;console.log("Data dikirim:",s),g.value=!0;try{await B.post("admin/transaksi",s)&&(x.success("Info","Data berhasil ditambahkan!"),T.push({name:"admin-transaksi"}))}catch(i){let l="Terjadi kesalahan jaringan atau server.";(v=(e=i.response)==null?void 0:e.data)!=null&&v.message?l=i.response.data.message:i.message&&(l=i.message),x.danger("Error",l),console.error("Kesalahan saat submit:",i)}finally{g.value=!1}},X=()=>{const s=t.value.nominal.toString().replace(/\D/g,"");if(!s){t.value.nominal="";return}const e=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0});t.value.nominal=e.format(parseInt(s,10))};return(s,e)=>{var i;const v=aa("v-select");return d(),u("div",da,[a("div",ua,[a("div",null,[ma,a("p",ca,[_(" Data Transaksi untuk pengguna: "),a("span",pa,f(((i=h.value)==null?void 0:i.username)||"..."),1)])]),a("div",_a,[a("button",{onClick:e[0]||(e[0]=l=>o(T).back()),class:"btn btn-ghost"},[va,_(" Kembali ")])])]),w.value?(d(),u("span",ga,[m(o(Y))])):K.value?(d(),u("span",fa,[m(o(G),{message:"Gagal mendapatkan response dari server"})])):(d(),u("span",ba,[a("div",xa,[a("div",ka,[a("a",{class:b(["tab",{"tab-active":t.value.jenis=="Pengeluaran"}]),onClick:e[1]||(e[1]=l=>J())}," ðŸ’¸ Pengeluaran ",2),a("a",{class:b(["tab",{"tab-active":t.value.jenis=="Pemasukan","tab-disabled":!p.value}]),onClick:e[2]||(e[2]=l=>W())}," ðŸ’° Pemasukan ",2)])]),t.value?(d(),u("div",ha,[a("div",ya,[a("div",Da,[m(o(la),{onSubmit:q},{default:C(({errors:l})=>[a("div",wa,[a("div",null,[Pa,m(o(A),{rules:o(L).validateData2,modelValue:t.value.tgl,"onUpdate:modelValue":e[3]||(e[3]=n=>t.value.tgl=n),name:"tgl",type:"date",class:b(["input input-bordered w-full",{"input-error":l.tgl}])},null,8,["rules","modelValue","class"]),a("div",Aa,f(l.tgl),1)]),a("div",null,[a("label",Ta,[Va,p.value?E("",!0):(d(),u("span",ja,"(Hanya Kantor)"))]),m(o(A),{modelValue:t.value.jenis,"onUpdate:modelValue":e[4]||(e[4]=n=>t.value.jenis=n),name:"jenis",type:"hidden"},null,8,["modelValue"]),m(v,{class:b(["style-chooser w-full",{"border-error":D.value.kategori_id}]),options:y.value,modelValue:t.value.kategori_id,"onUpdate:modelValue":e[5]||(e[5]=n=>t.value.kategori_id=n),clearable:p.value,disabled:z.value,placeholder:"Pilih Kategori"},null,8,["options","modelValue","clearable","disabled","class"]),a("div",Sa,f(D.value.kategori_id),1)]),a("div",null,[Ia,m(o(A),{rules:o(L).validateData2,modelValue:t.value.nominal,"onUpdate:modelValue":e[6]||(e[6]=n=>t.value.nominal=n),name:"nominal",type:"text",class:b(["input input-bordered w-full",{"input-error":l.nominal}]),onKeyup:e[7]||(e[7]=n=>X()),placeholder:"Contoh: 15.000"},null,8,["rules","modelValue","class"]),a("div",Ka,f(l.nominal),1)]),a("div",Ra,[Na,m(o(A),{modelValue:t.value.nama,"onUpdate:modelValue":e[8]||(e[8]=n=>t.value.nama=n),name:"nama"},{default:C(({field:n})=>[a("textarea",ea(n,{class:["textarea textarea-bordered w-full h-24",{"textarea-error":l.nama}],placeholder:"Tulis keterangan transaksi di sini..."}),null,16)]),_:2},1032,["modelValue"]),a("div",Ca,f(l.nama),1)])]),a("div",Ea,[a("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:g.value},[g.value?(d(),u("span",Ua,[Ba,_(" Memproses... ")])):(d(),u("span",La,[Ma,_(" Simpan Transaksi ")]))],8,Fa)])]),_:1})])])])):E("",!0)]))])}}},Qa=ra($a,[["__scopeId","data-v-113f4bff"]]);export{Qa as default};
